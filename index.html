<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <!-- ===== PWA META TAGS HOÃ€N CHá»ˆNH ===== -->
  <!-- Viewport chuáº©n cho PWA -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">

  <!-- PWA Manifest -->
  <link rel="manifest" href="./manifest.json">

  <!-- Theme colors -->
  <meta name="theme-color" content="#b71c1c">
  <meta name="msapplication-navbutton-color" content="#b71c1c">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">

  <!-- Apple PWA Settings -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="eTax Mobile">

  <!-- Apple Touch Icons -->
  <link rel="apple-touch-icon" href="./assets/logo.png">
  <link rel="apple-touch-icon" sizes="152x152" href="./assets/logo.png">
  <link rel="apple-touch-icon" sizes="180x180" href="./assets/logo.png">
  <link rel="apple-touch-icon" sizes="167x167" href="./assets/logo.png">

  <!-- Splash Screen Images cho iOS -->
  <link rel="apple-touch-startup-image" href="./assets/splash-2048x2732.png" sizes="2048x2732">
  <link rel="apple-touch-startup-image" href="./assets/splash-1668x2224.png" sizes="1668x2224">
  <link rel="apple-touch-startup-image" href="./assets/splash-1536x2048.png" sizes="1536x2048">
  <link rel="apple-touch-startup-image" href="./assets/splash-1125x2436.png" sizes="1125x2436">
  <link rel="apple-touch-startup-image" href="./assets/splash-1242x2208.png" sizes="1242x2208">
  <link rel="apple-touch-startup-image" href="./assets/splash-750x1334.png" sizes="750x1334">
  <link rel="apple-touch-startup-image" href="./assets/splash-640x1136.png" sizes="640x1136">

  <!-- Microsoft PWA -->
  <meta name="msapplication-starturl" content="./index.html">
  <meta name="msapplication-TileColor" content="#b71c1c">
  <meta name="msapplication-TileImage" content="./assets/logo.png">

  <!-- Táº¯t sá»‘ Ä‘iá»‡n thoáº¡i tá»± Ä‘á»™ng link -->
  <meta name="format-detection" content="telephone=no">
  <meta name="format-detection" content="email=no">
  <meta name="format-detection" content="address=no">

  <!-- Security headers -->
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">

  
  <title>eTax Mobile - Home (v20250720-2)</title>
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="css/home.css" />
  
  <!-- ThÆ° viá»‡n Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

  <style>
    /* âœ… NATIVE APP - Cá» Äá»ŠNH MÃ€N HÃŒNH NHÆ¯ APP MOBILE THáº¬T */
    /* Reset vÃ  chuáº©n hÃ³a toÃ n bá»™ giao diá»‡n */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: 'Segoe UI', 'Tahoma', 'Microsoft Sans Serif', 'Arial', sans-serif;
  touch-action: manipulation;
  -webkit-overflow-scrolling: touch;
  -webkit-tap-highlight-color: transparent;
}

html {
  margin: 0 !important;
  padding: 0 !important;
  width: 100vw !important;
  height: 100vh !important;
  background: #000 !important;
  box-sizing: border-box;
  /* âœ… CHO PHÃ‰P SCROLL - HTML LEVEL */
  overflow: visible;
  overscroll-behavior: none !important;
  -webkit-overscroll-behavior: none !important;
  overscroll-behavior-x: none !important;
  overscroll-behavior-y: none !important;
  /* âœ… CHO PHÃ‰P TOUCH CÆ  Báº¢N */
  touch-action: pan-y;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  user-select: none;
  /* ğŸ”’ KHÃ“A ZOOM */
  -webkit-text-size-adjust: 100% !important;
  -ms-text-size-adjust: 100% !important;
}

body {
  margin: 0 !important;
  padding: 0 !important;
  width: 100vw !important;
  height: 100vh !important;
  background: #000 !important;
  box-sizing: border-box;
  /* âœ… CHO PHÃ‰P SCROLL - BODY Cáº¦N SCROLL */
  overflow: visible;
  overscroll-behavior: none !important;
  -webkit-overscroll-behavior: none !important;
  overscroll-behavior-x: none !important;
  overscroll-behavior-y: none !important;
  /* âœ… CHO PHÃ‰P SCROLL VÃ€ TOUCH CÆ  Báº¢N */
  touch-action: pan-y;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  user-select: none;
  /* ğŸ”’ PWA Safe Area */
  padding-top: env(safe-area-inset-top, 0px);
  padding-bottom: env(safe-area-inset-bottom, 0px);
  padding-left: env(safe-area-inset-left, 0px);
  padding-right: env(safe-area-inset-right, 0px);
  /* ğŸ”’ Cá» Äá»ŠNH LAYOUT */
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: center;
  position: relative;
}

/* âœ… BODY ÄÃƒ ÄÆ¯á»¢C Äá»ŠNH NGHÄ¨A á» TRÃŠN - Bá» DUPLICATE */

.phone-frame {
  width: 100vw;
  height: 100vh !important; /* âœ… Cá» Äá»ŠNH CHIá»€U CAO = VIEWPORT */
  background-image: url('assets/nen.png');
  background-size: cover;
  background-repeat: no-repeat;
  background-position: center center;
  border-radius: 0;
  box-shadow: none;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: stretch;
  /* âœ… NATIVE APP CONTAINER - CHO PHÃ‰P SCROLL */
  overflow: visible;
  position: relative; /* âœ… Sá»¬A Láº I POSITION */
}

@media (min-width: 601px) {
  .phone-frame {
    border-radius: 30px;
    margin: 32px auto;
    box-shadow: 0 0 20px rgba(0,0,0,0.3);
    width: 400px;
  }
}

/* âœ… TOPBAR - ADJUSTED TO LOGO TEXT BOTTOM AS REQUESTED */
.topbar {
  position: fixed; /* âœ… FIXED POSITION FOR NATIVE APP FEEL */
  top: 0;
  left: 0;
  right: 0;
  z-index: 1000;
  background-color: #b71c1c; /* ğŸ”´ CHANGED TO #b71c1c AS REQUESTED */
  color: white;
  padding: 12px 20px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  height: 95px; /* âœ… REDUCED TO ALIGN WITH LOGO TEXT BOTTOM */
  /* ğŸ”’ PWA Safe Area */
  padding-top: max(12px, env(safe-area-inset-top));
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

/* Vá»Š TRÃ A: Menu burger bÃªn trÃ¡i - Ä‘Ã£ Ä‘Ãºng */
.left-menu {
  font-size: 24px;
  color: white;
  padding-left: 10px;
  cursor: pointer;
}

/* Vá»Š TRÃ GIá»®A: Logo + text - di chuyá»ƒn sang pháº£i vÃ  xuá»‘ng tháº¥p */
.center-logo {
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  flex-grow: 1;
  text-align: center;
  margin-left: 30px; /* ğŸ”§ Di chuyá»ƒn sang pháº£i */
  margin-top: 15px; /* ğŸ”§ Di chuyá»ƒn xuá»‘ng tháº¥p */
}

.center-logo img {
  height: 45px;
  margin-bottom: 6px;
}

.center-logo span {
  font-weight: bold;
  font-size: 17px;
  letter-spacing: 0.5px;
}

/* Vá»Š TRÃ B: QR + Bell icons bÃªn pháº£i - chá»‰nh tháº³ng hÃ ng */
.right-icon {
  display: flex;
  align-items: center;
  gap: 10px;
  padding-right: 10px;
}

.right-icon img {
  height: 24px;
}

.user-info {
  background-image: url('assets/backgrounftd.png');
  background-size: cover;
  background-position: center;
  display: flex;
  align-items: center;
  padding: 18px;
  margin: 6px 16px; /* ğŸ”§ Giáº£m margin top/bottom tá»« 12px â†’ 6px */
  border-radius: 15px;
  box-shadow: 0 3px 8px rgba(0,0,0,0.15);
}

.avatar {
  height: 52px;
  width: 52px;
  border-radius: 50%;
  margin-right: 18px;
  border: 2px solid rgba(255,255,255,0.3);
}

.userinfo-text .mst {
  font-size: 14px;
  color: #333;
  font-weight: 500;
}

.userinfo-text .username {
  font-size: 18px;
  font-weight: bold;
  color: #a40000;
  margin-top: 2px;
}

.quick-actions,
.group-services {
  margin: 4px 16px; /* ğŸ”§ Giáº£m tá»« 8px â†’ 4px Ä‘á»ƒ dá»“n gáº§n nhau */
}

h3 {
  font-size: 16px;
  font-weight: bold;
  margin-bottom: 8px; /* ğŸ”§ Giáº£m tá»« 12px â†’ 8px */
  color: white;
}

.scroll-row {
  display: flex;
  overflow-x: auto;
  gap: 12px;
}

.circle-item {
  background-color: #a40000;
  color: white;
  padding: 12px;
  border-radius: 50%;
  min-width: 80px;
  min-height: 80px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  font-size: 10px;
  text-align: center;
  word-break: break-word;
  white-space: normal;
}

.grid-box {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 8px;
}

.grid-item {
  background-color: white;
  border-radius: 12px;
  padding: 14px 8px;
  text-align: center;
  font-size: 12px;
  color: #000;
  box-shadow: 0 2px 6px rgba(0,0,0,0.15);
  transition: transform 0.2s ease;
  cursor: pointer;
  min-height: 85px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.grid-item:hover {
  transform: scale(1.02);
}

.grid-item img {
  height: 35px;
  margin-bottom: 6px;
  object-fit: contain;
}

/* Slide menu - Clone app gá»‘c 870x1883 */
.slide-menu {
  position: fixed;
  top: 0;
  left: -320px;
  width: 320px; /* ğŸ”§ TÄƒng width giá»‘ng app gá»‘c */
  height: 100vh;
  background: white;
  z-index: 9999;
  transition: none; /* ğŸ”§ Bá» transition Ä‘á»ƒ mÆ°á»£t hÆ¡n */
  overflow-y: hidden; /* ğŸ”§ áº¨n scroll bar chÃ­nh */
  box-shadow: 2px 0 12px rgba(0,0,0,0.3); /* ğŸ”§ Shadow Ä‘áº­m hÆ¡n */
}

.slide-menu.open {
  left: 0;
}

.slide-header {
  background-image: url('assets/back.png');
  background-size: cover;
  background-repeat: no-repeat;
  color: white;
  text-align: center;
  padding: 20px 0; /* ğŸ”§ Full width padding */
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 100%; /* ğŸ”§ Full width */
  /* ğŸ”’ PWA Safe Area */
  padding-top: max(20px, env(safe-area-inset-top));
}

.slide-header .logo {
  width: 160px; /* ğŸ”§ Giáº£m kÃ­ch thÆ°á»›c Ä‘á»ƒ gá»n hÆ¡n */
  height: 160px;
  margin-bottom: 12px;
  object-fit: contain;
}

/* ğŸ”§ ThÃªm greeting box full width */
.slide-greeting {
  background-color: #b71c1c;
  color: white;
  padding: 16px 20px;
  text-align: left;
  font-size: 18px;
  font-weight: bold;
  border-bottom: 2px solid rgba(255,255,255,0.1);
  width: 100%;
}

.slide-links {
  display: flex;
  flex-direction: column;
  padding: 0; /* ğŸ”§ Bá» padding Ä‘á»ƒ scroll items tá»± handle */
  height: calc(100vh - 280px); /* ğŸ”§ Chiá»u cao chÃ­nh xÃ¡c */
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
}

.slide-links a {
  text-decoration: none;
  color: #333;
  padding: 16px 20px; /* ğŸ”§ Padding rá»™ng hÆ¡n nhÆ° app gá»‘c */
  font-size: 16px; /* ğŸ”§ Font size lá»›n hÆ¡n */
  display: flex;
  align-items: center;
  border-bottom: 1px solid #f0f0f0; /* ğŸ”§ ThÃªm border giá»¯a items */
  transition: none; /* ğŸ”§ Bá» transition */
}

.slide-links a:hover {
  background-color: #f5f5f5; /* ğŸ”§ Hover effect nháº¹ */
}

.slide-links a img {
  width: 32px; /* ğŸ”§ Icon size chuáº©n */
  height: 32px;
  margin-right: 16px; /* ğŸ”§ Spacing giá»¯a icon vÃ  text */
  object-fit: contain;
}

.slide-links a:last-child {
  color: #d62828 !important; /* ğŸ”§ MÃ u Ä‘á» cho Ä‘Äƒng xuáº¥t */
  font-weight: bold;
  border-top: 2px solid #f0f0f0;
  margin-top: 8px;
}

/* ğŸ”§ Scroll optimization cho slide-links */
.slide-links::-webkit-scrollbar {
  display: none;
}

.slide-links {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

/* ğŸ”§ Menu overlay backdrop */
.menu-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0, 0, 0, 0.5);
  z-index: 9998;
  display: none;
}

.menu-overlay.show {
  display: block;
}

/* NÃºt Ä‘Äƒng nháº­p */
.btn-login {
  width: 100%;
  max-width: 340px;
  margin: 0 auto;
  display: block;
}
.content-scrollable {
  flex: 1;
  display: flex;
  flex-direction: column;
  padding: 10px;
  gap: 0;
  /* âœ… Bá» SCROLL - CHá»ˆ LÃ€ CONTAINER */
  overflow: hidden;
  /* ğŸ”’ KHÃ“A TRIá»†T Äá»‚ OVERSCROLL */
  overscroll-behavior: none !important;
  -webkit-overscroll-behavior: none !important;
  overscroll-behavior-x: none !important;
  overscroll-behavior-y: none !important;
  /* ğŸ”’ CHá»ˆ CHO PHÃ‰P SCROLL Dá»ŒC TRONG CONTENT */
  touch-action: pan-y !important;
  -webkit-overflow-scrolling: touch;
  position: relative;
  /* âœ… FLEXBOX Tá»° NHIÃŠN - CHO PHÃ‰P EXPAND */
  /* Bá» táº¥t cáº£ height cá»‘ Ä‘á»‹nh Ä‘á»ƒ flex-grow hoáº¡t Ä‘á»™ng */
}

.content-scrollable::-webkit-scrollbar {
  display: none;
}

/* âœ… áº¨N SCROLLBAR HOÃ€N TOÃ€N CHO Táº¤T Cáº¢ ELEMENTS */
.scrollable-content::-webkit-scrollbar {
  display: none;
}

.scrollable-content {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

.main-content-wrapper::-webkit-scrollbar {
  display: none;
}

.main-content-wrapper {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

/* âœ… PERFORMANCE OPTIMIZATION - Bá» táº¥t cáº£ animation */
*, *::before, *::after {
  animation-duration: 0s !important;
  animation-delay: 0s !important;
  transition-duration: 0s !important;
  transition-delay: 0s !important;
  transform: none !important;
}

/* âœ… PWA Native App Appearance */
@supports (-webkit-touch-callout: none) {
  .phone-frame {
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -webkit-tap-highlight-color: transparent;
  }
}

.login-form, .container {
  width: 100%;
  max-width: 340px;
  margin: 0 auto;
}

/* Section danh sÃ¡ch nhÃ³m dá»‹ch vá»¥ - PWA Single Screen */
.service-grid-section {
    background: #ffffff;
    padding: 15px;
    margin: 6px 12px 20px 12px; /* ÄÃ£ thÃªm margin-bottom */
    border-radius: 14px 14px 0 0;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    
    /* ğŸ¯ AUTO HEIGHT: Äá»ƒ content tá»± quyáº¿t Ä‘á»‹nh chiá»u cao */
    /* height: calc(100vh - 530px); - Bá» Cá» Äá»ŠNH */
    /* min-height: 400px; - ÄÃ£ xÃ³a Ä‘á»ƒ section co láº¡i */
    /* max-height: 400px; - Bá» GIá»šI Háº N Ä‘á»ƒ scroll Ä‘Æ°á»£c */
    display: flex;
    flex-direction: column;
    
    /* Äáº£m báº£o cÃ³ padding-bottom Ä‘á»ƒ khÃ´ng sÃ¡t mÃ©p */
    padding-bottom: 15px; /* ÄÃ£ giáº£m padding-bottom */
    
    /* Responsive cho cÃ¡c thiáº¿t bá»‹ khÃ¡c nhau */
    overflow: hidden; /* Bá» scroll riÃªng cá»§a section */
}

.service-grid-section h3 {
    margin-bottom: 16px;
    font-size: 18px;
    color: black;
}

/* LÆ°á»›i chá»©a cÃ¡c icon dá»‹ch vá»¥ */
.grid-box {
    display: grid;
    /* Tá»± Ä‘á»™ng chia 3 cá»™t Ä‘á»u nhau */
    grid-template-columns: repeat(3, 1fr);
    /* Khoáº£ng cÃ¡ch giá»¯a cÃ¡c icon */
    gap: 16px;
    padding-top: 15px;
}

.grid-item {
    text-align: center;
    cursor: pointer;
}

.grid-item .icon-background {
    background: white;
    border-radius: 10px;
    padding: 6px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    display: inline-block;
    margin-bottom: 8px;
}

.grid-item img {
    width: 55px;
    height: 55px;
    display: block;
}

.grid-item span {
    display: block;
    font-size: 15px;
    font-weight: 500;
    line-height: 1.3;
    color: #000;
}

  </style>
  
  <script>
    // ÄÄƒng kÃ½ Service Worker
    if ('serviceWorker' in navigator) {
    window.addEventListener('load', function() {
      navigator.serviceWorker.register('./sw.js')
        .then(function(registration) {
          console.log('âœ… ServiceWorker registered successfully');
        })
        .catch(function(error) {
          console.log('âŒ ServiceWorker registration failed');
        });
    });
    }
  }
  </script>
  <script>

  // Táº¯t context menu
  document.addEventListener('contextmenu', function(e) {
    e.preventDefault();
  });

  // Táº¯t drag
  document.addEventListener('dragstart', function(e) {
    e.preventDefault();
  });

  // Kháº¯c phá»¥c iOS Safari swipe back
  document.addEventListener('touchstart', function(e) {
    if (e.touches.length > 1) {
      e.preventDefault();
    }
  });

  let lastTouchEnd = 0;
  document.addEventListener('touchend', function(e) {
    const now = (new Date()).getTime();
    if (now - lastTouchEnd <= 300) {
      e.preventDefault();
    }
    lastTouchEnd = now;
  }, false);

  // Kháº¯c phá»¥c double tap zoom
  let lastTouchTime = 0;
  document.addEventListener('touchstart', function(e) {
    const now = Date.now();
    if (now - lastTouchTime <= 500) {
      e.preventDefault();
    }
    lastTouchTime = now;
  });

  // Táº¯t pull to refresh
  let startY = 0;
  document.addEventListener('touchstart', function(e) {
    startY = e.touches[0].clientY;
  });

  document.addEventListener('touchmove', function(e) {
    const y = e.touches[0].clientY;
    if (startY <= 10 && y > startY) {
      e.preventDefault();
    }
  });

  // Kháº¯c phá»¥c viewport height cho mobile
  function setViewportHeight() {
    const vh = window.innerHeight * 0.01;
    document.documentElement.style.setProperty('--vh', vh + 'px');
  }

  window.addEventListener('resize', setViewportHeight);
  window.addEventListener('orientationchange', function() {
    setTimeout(setViewportHeight, 500);
  });
  setViewportHeight();

  // Orientation lock warning
  function checkOrientation() {
    if (window.innerHeight < 500 && window.innerWidth > window.innerHeight) {
      document.body.classList.add('landscape-mode');
    } else {
      document.body.classList.remove('landscape-mode');
    }
  }

  window.addEventListener('orientationchange', function() {
    setTimeout(checkOrientation, 500);
  });
  window.addEventListener('resize', checkOrientation);
  checkOrientation();
  </script>

  <!-- CSS cho orientation warning -->
  <style>
  .landscape-mode .orient
  ation-warning {
    display: flex !important;
  }


  .landscape-mode .phone-frame,
  .landscape-mode .app-container,
  .landscape-mode .main-container {
    display: none !important;
  }
  </style>

</head>

<body>
  
  <div class="phone-frame">
    <div id="slideMenu" class="slide-menu">
      <div class="slide-header" style="height: 327px; position: relative; background-color: #b71c1c; background-image: url('assets/slidebg.png'); background-size: cover; background-position: center; padding: 37px 0 15px 0; display: flex; flex-direction: column; justify-content: flex-start; align-items: center;">
        <img src="assets/logo.png" class="logo" style="width: 130px; height: 130px; margin-bottom: 15px; margin-top: 20px;" />
        <div class="slide-greeting" style="background: r
             gba(216,14,4,255); color: white; padding: 12px 20px; text-align: left; font-size: 22px; font-weight: 600; line-height: 1.3; box-shadow: inset 0 2px 4px rgba(255,255,255,0.2), 0 1px 3px rgba(0,0,0,0.3); width: 100%; margin: 0 0 15px 0;">
          <div>Xin chÃ o Nguyá»…n Trung</div>
          <div style="font-size: 24px; font-weight: bold; margin-top: 5px;">NghÄ©a</div>
        </div>
      </div>
      <div class="slide-links" style="padding: 0; overflow-y: auto; max-height: calc(100vh - 327px);">
        <a href="#" onclick="location.reload()" style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
          <img src="assets/trangchu.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> Trang chá»§
        </a>
        <a href="hoadondt.html" style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
          <img src="assets/index1.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> HÃ³a Ä‘Æ¡n Ä‘iá»‡n tá»­
        </a>
        <a href="khaithue.html" style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
          <img src="assets/icon5.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> Khai thuáº¿
        </a>
        <a href="dangky.html" style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
          <img src="assets/icon5.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> ÄÄƒng kÃ½ thuáº¿
        </a>
        <a href="ho-tro-qtt.html" style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
          <img src="assets/icon6.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> Há»— trá»£ quyáº¿t toÃ¡n thuáº¿ TNCN
        </a>
        <a href="hoso.html" style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
          <img src="assets/icon7.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> Tra cá»©u há»“ sÆ¡ khai thuáº¿
        </a>
        <a href="nopthue.html" style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
          <img src="assets/icon8.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> NhÃ³m chá»©c nÄƒng ná»™p thuáº¿
        </a>
        <a href="nghiavu.html" style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
          <img src="assets/icon9.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> Tra cá»©u nghÄ©a vá»¥ thuáº¿
        </a>
        <a href="thongbao.html" style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
          <img src="assets/icon10.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> Tra cá»©u thÃ´ng bÃ¡o
        </a>
        <a href="tienich.html" style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
          <img src="assets/icon11.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> Tiá»‡n Ã­ch
        </a>
        <a href="hotro.html" style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
          <img src="assets/icon12.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> Há»— trá»£
        </a>
        <a href="thietlap.html" style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
          <img src="assets/icon13.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> Thiáº¿t láº­p cÃ¡ nhÃ¢n
        </a>
        <a href="#" style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
          <img src="assets/icon-doimk.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> Äá»•i máº­t kháº©u Ä‘Äƒng nháº­p
        </a>
        <a href="#" style="padding: 16px 20px; border-bottom: 1px solid #f0f0f0;">
          <img src="assets/faceid.png" width="32" height="32" style="object-fit: cover; margin-right: 16px;"> ÄÄƒng nháº­p báº±ng vÃ¢n tay / FaceID
        </a>
        <div style="padding: 20px; border-top: 1px solid #f0f0f0; margin-top: 10px;">
          <button onclick="logout()" style="
            width: 100%;
            background: linear-gradient(135deg, #b71c1c, #d32f2f);
            color: white;
            border: none;
            border-radius: 25px;
            padding: 15px 20px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(183, 28, 28, 0.3);
            transition: transform 0.1s ease;
          " onmousedown="this.style.transform='scale(0.98)'" onmouseup="this.style.transform='scale(1)'">
            ÄÄƒng xuáº¥t
          </button>
        </div>
      </div>
    </div>

    <div id="menuOverlay" class="menu-overlay" onclick="closeMenu()"></div>

    <!-- âœ… HEADER - EXTENDED TO MST TEXT LEVEL -->
    <header class="topbar" style="position: fixed; top: 0; left: 0; right: 0; z-index: 1000; height: 100px; margin: 0;">
      <div class="left-menu" onclick="openMenu()">â˜°</div>
      <div class="center-logo">
        <img src="assets/logo.png" alt="Logo" />
        <span>eTax Mobile</span>
      </div>
      <div class="right-icon">
        <img src="assets/icon-qr.png" alt="QR" style="width: 32px; height: 32px;" />
        <a href="thongbao.html"><img src="assets/icon-bell.png" alt="Bell" style="width: 32px; height: 32px;" /></a>
      </div>
    </header>
    <div class="content-scrollable" style="padding-top: 100px; /* âœ… SPACING ÄÃšNG NHÆ¯ BACKUP */">
      <div class="unified-viewport" style="height: calc(100vh - 100px); overflow: hidden; background: transparent; max-width: 420px; margin: 0 auto;">
        <div class="scrollable-content" style="height: 100%; overflow-y: auto; -webkit-overflow-scrolling: touch; overscroll-behavior: contain; padding-right: 10px;">
        <section class="user-info" style="width: calc(100vw - 20px); max-width: 420px; border-radius: 16px; background-color: #ffffff; display: flex; align-items: center; padding: 8px 12px; margin: 6px auto; min-height: 120px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">

        <img class="avatar" src="assets/avatar.png" alt="Avatar" style="width: 80px; height: 80px;" />
        <div class="userinfo-text" style="margin-left: 2px; flex-grow: 1;">
          <div class="mst" style="color: black; font-size: 18px; font-weight: 400;" id="user-mst">MST: ...</div>
          <div class="username" style="display: flex; align-items: center; gap: 8px; white-space: nowrap; font-size: 20px; font-weight: 500; color: #5B0000; text-transform: uppercase;">
            <span id="user-name">(ChÆ°a Ä‘Äƒng nháº­p)</span><a href="thongtin.html"><img src="assets/nutha.png" alt="ThÃ´ng tin" style="width: 20px; height: 20px; margin-left: 5px;"></a>
          </div>
        </div>
      </section>

        <section style="background-color: #ffffff; min-height: 220px; border-radius: 16px; width: calc(100vw - 20px); max-width: 420px; margin: 6px auto; position: relative; overflow: hidden; padding: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
        <div style="display: flex; align-items: center; justify-content: space-between;">
          <h3 style="color: black; margin: 0; font-size: 20px; font-weight: normal;">&nbsp;&nbsp;Chá»©c nÄƒng hay dÃ¹ng</h3>
          <img src="assets/2gach.png" alt="cÃ i Ä‘áº·t" style="width: 30px; height: 20px; margin-right: 10px;" />
        </div>

        <button onclick="scrollLeft()" style="position: absolute; left: 0; top: 50%; transform: translateY(-50%); background: none; border: none; z-index: 10;">
          <img src="assets/arrow-left.png" style="width: 30px;" />
        </button>

        <button onclick="scrollRight()" style="position: absolute; right: 0; top: 50%; transform: translateY(-50%); background: none; border: none; z-index: 10;">
          <img src="assets/arrow-right.png" style="width: 30px;" />
        </button>

        <div id="scrollable" style="display: flex; overflow-x: auto; overflow-y: hidden; scroll-behavior: smooth; -webkit-overflow-scrolling: touch; scrollbar-width: none; -ms-overflow-style: none; gap: 15px; padding: 5px 20px 8px 20px; height: 180px; align-items: flex-start; touch-action: pan-x; position: relative; z-index: 1;">
          <div style="text-align: center; min-width: 90px; flex-shrink: 0; cursor: pointer; padding: 4px;" onclick="javascript:location.href='tracuttnpt.html';">
            <img src="assets/icon1.png" style="width: 58px; height: 58px; margin-bottom: 3px;" /><br>
            <span style="display: inline-block; line-height: 1.6; font-size: 16px; font-weight: 500;">Tra cá»©u<br>thÃ´ng tin<br>ngÆ°á»i phá»¥<br>thuá»™c</span>
          </div>
          <div style="text-align: center; min-width: 90px; flex-shrink: 0; cursor: pointer; padding: 4px;" onclick="javascript:location.href='hsdkythue.html';">
            <img src="assets/icon2.png" style="width: 58px; height: 58px; margin-bottom: 3px;" /><br>
            <span style="display: inline-block; line-height: 1.6; font-size: 16px; font-weight: 500;">Há»“ sÆ¡<br>Ä‘Äƒng kÃ½<br>thuáº¿</span>
          </div>
          <div style="text-align: center; min-width: 90px; flex-shrink: 0; padding: 4px;">
            <img src="assets/icon3.png" style="width: 58px; height: 58px; margin-bottom: 3px;" /><br>
            <span style="display: inline-block; line-height: 1.6; font-size: 16px; font-weight: 500;">Há»“ sÆ¡<br>quyáº¿t<br>toÃ¡n thuáº¿</span>
          </div>
          <div style="text-align: center; min-width: 90px; flex-shrink: 0; padding: 4px;">
            <img src="assets/icon4.png" style="width: 58px; height: 58px; margin-bottom: 3px;" /><br>
            <span style="display: inline-block; line-height: 1.6; font-size: 16px; font-weight: 500;">Tra cá»©u<br>thÃ´ng tin<br>quyáº¿t<br>toÃ¡n</span>
          </div>
          <div style="text-align: center; min-width: 90px; flex-shrink: 0; cursor: pointer; padding: 4px;" onclick="javascript:location.href='tra-cuu-chung-tu.html';">
            <img src="assets/icon4.png" style="width: 58px; height: 58px; margin-bottom: 3px;" /><br>
            <span style="display: inline-block; line-height: 1.6; font-size: 16px; font-weight: 500;">Tra cá»©u<br>chá»©ng tá»«<br>thuáº¿</span>
          </div>
        </div>
      </section>

        <section style="background: #ffffff; padding: 15px; width: calc(100vw - 20px); max-width: 420px; margin: 6px auto 0 auto; font-family: sans-serif; border-radius: 14px; min-height: 320px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); flex-grow: 1;">
        <h3 style="margin-bottom: 16px; font-size: 18px; color: black;">Danh sÃ¡ch nhÃ³m dá»‹ch vá»¥</h3>
        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; padding: 15px 5px 20px 5px;">
          <div onclick="window.location.href='hoadondt.html'" style="text-align: center; cursor: pointer;">
            <div style="background: white; border-radius: 10px; padding: 0px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); display: inline-block; margin-bottom: 8px;">
              <img src="assets/index1.png" style="width: 55px; height: 55px;" />
            </div>
            <span style="display: block; font-size: 16px; font-weight: 500; line-height: 1.3;">HoÃ¡ Ä‘Æ¡n Ä‘iá»‡n<br>tá»­</span>
          </div>
          <div onclick="window.location.href='khaithue.html'" style="text-align: center; cursor: pointer;">
            <div style="background: white; border-radius: 10px; padding: 0px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); display: inline-block; margin-bottom: 8px;">
              <img src="assets/index2.png" style="width: 55px; height: 55px;" />
            </div>
            <span style="display: block; font-size: 16px; font-weight: 500; line-height: 1.3;">Khai thuáº¿</span>
          </div>
          <div onclick="window.location.href='dangky.html'" style="text-align: center; cursor: pointer;">
            <div style="background: white; border-radius: 10px; padding: 0px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); display: inline-block; margin-bottom: 8px;">
              <img src="assets/index3.png" style="width: 55px; height: 55px;" />
            </div>
            <span style="display: block; font-size: 16px; font-weight: 500; line-height: 1.3;">ÄÄƒng kÃ½ thuáº¿</span>
          </div>
          <div onclick="window.location.href='ho-tro-qtt.html'" style="text-align: center; cursor: pointer;">
            <div style="background: white; border-radius: 10px; padding: 0px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); display: inline-block; margin-bottom: 8px;">
              <img src="assets/index4.png" style="width: 55px; height: 55px;" />
            </div>
            <span style="display: block; font-size: 16px; font-weight: 500; line-height: 1.3;">Há»— trá»£ quyáº¿t toÃ¡n thuáº¿<br>TNCN</span>
          </div>
          <div onclick="window.location.href='nopthue.html'" style="text-align: center; cursor: pointer;">
            <div style="background: white; border-radius: 10px; padding: 0px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); display: inline-block; margin-bottom: 8px;">
              <img src="assets/index5.png" style="width: 55px; height: 55px;" />
            </div>
            <span style="display: block; font-size: 16px; font-weight: 500; line-height: 1.3;">NhÃ³m chá»©c<br>nÄƒng ná»™p<br>thuáº¿</span>
          </div>
          <div onclick="window.location.href='nghiavu.html'" style="text-align: center; cursor: pointer;">
            <div style="background: white; border-radius: 10px; padding: 0px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); display: inline-block; margin-bottom: 8px;">
              <img src="assets/index6.png" style="width: 55px; height: 55px;" />
            </div>
            <span style="display: block; font-size: 16px; font-weight: 500; line-height: 1.3;">Tra cá»©u nghÄ©a<br>vá»¥ thuáº¿</span>
          </div>
          <div onclick="window.location.href='thongbao.html'" style="text-align: center; cursor: pointer;">
            <div style="background: white; border-radius: 10px; padding: 0px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); display: inline-block; margin-bottom: 8px;">
              <img src="assets/index7.png" style="width: 55px; height: 55px;" />
            </div>
            <span style="display: block; font-size: 16px; font-weight: 500; line-height: 1.3;">Tra cá»©u thÃ´ng<br>bÃ¡o</span>
          </div>
          <div onclick="window.location.href='tienich.html'" style="text-align: center; cursor: pointer;">
            <div style="background: white; border-radius: 10px; padding: 0px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); display: inline-block; margin-bottom: 8px;">
              <img src="assets/index8.png" style="width: 55px; height: 55px;" />
            </div>
            <span style="display: block; font-size: 16px; font-weight: 500; line-height: 1.3;">Tiá»‡n Ã­ch</span>
          </div>
          <div onclick="window.location.href='hotro.html'" style="text-align: center; cursor: pointer;">
            <div style="background: white; border-radius: 10px; padding: 0px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); display: inline-block; margin-bottom: 8px;">
              <img src="assets/index9.png" style="width: 55px; height: 55px;" />
            </div>
            <span style="display: block; font-size: 16px; font-weight: 500; line-height: 1.3;">Há»— trá»£</span>
          </div>
          <div onclick="window.location.href='thietlap.html'" style="text-align: center; cursor: pointer;">
            <div style="background: white; border-radius: 10px; padding: 0px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); display: inline-block; margin-bottom: 8px;">
              <img src="assets/index10.png" style="width: 55px; height: 55px;" />
            </div>
            <span style="display: block; font-size: 16px; font-weight: 500; line-height: 1.3;">Thiáº¿t láº­p cÃ¡ nhÃ¢n</span>
          </div>
        </div>
      </section>

        
        </div>
      </div>
    </div>
  </div>

  <script>
    // QUAN TRá»ŒNG: Disable device_auth_manager cho index.html
    window.DISABLE_DEVICE_AUTH_MANAGER = true;
    
    // ğŸ”§ FIX: Force clear cache vÃ  disable conflicting scripts
    if ('caches' in window) {
      caches.keys().then(names => {
        names.forEach(name => {
          caches.delete(name);
        });
      });
    }
    
    console.log('=== INDEX.HTML LOADED ===');
    console.log('localStorage debug:', {
      device_verified: localStorage.getItem('etax_device_verified'),
      token_verified: localStorage.getItem('etax_token_verified'),
      logged_in_user: localStorage.getItem('etax_logged_in_user'),
      login_success: localStorage.getItem('etax_login_success')
    });
    
    // ğŸ”§ FIX: Kiá»ƒm tra xÃ¡c thá»±c Æ¯U TIÃŠN user login trÆ°á»›c
    const tokenVerified = localStorage.getItem('etax_token_verified');
    const deviceVerified = localStorage.getItem('etax_device_verified');
    const loggedInUser = localStorage.getItem('etax_logged_in_user');
    const loginSuccess = localStorage.getItem('etax_login_success');
    
    console.log('ğŸ” Index verification check:', {
      tokenVerified: tokenVerified,
      deviceVerified: deviceVerified,
      loggedInUser: loggedInUser,
      loginSuccess: loginSuccess
    });
    
    // ğŸ”§ FIX: Náº¿u user Ä‘Ã£ login thÃ nh cÃ´ng, SKIP device check
    if (loggedInUser && loginSuccess === 'true') {
      console.log('âœ… User already logged in - STAYING on index.html');
      
      // Äáº£m báº£o device flags tá»“n táº¡i Ä‘á»ƒ trÃ¡nh láº§n sau bá»‹ redirect
      if (!deviceVerified || !tokenVerified) {
        console.log('ğŸ”§ Backfilling missing device flags...');
        localStorage.setItem('etax_device_verified', 'true');
        localStorage.setItem('etax_token_verified', 'true');
        if (!localStorage.getItem('etax_device_id')) {
          localStorage.setItem('etax_device_id', 'dev_from_login_' + Date.now());
        }
        // Backup MST náº¿u cÃ³
        if (!localStorage.getItem('etax_verified_mst') && loggedInUser) {
          localStorage.setItem('etax_verified_mst', loggedInUser);
        }
      }
    } else if (tokenVerified !== 'true' || deviceVerified !== 'true') {
      console.log('âŒ Index verification FAILED - redirecting to token-login');
      console.log('  â†’ token=' + tokenVerified + ', device=' + deviceVerified);
      
      // Delay redirect Ä‘á»ƒ cÃ³ thá»ƒ tháº¥y page load
      setTimeout(() => {
        window.location.href = 'token-login.html';
      }, 100);
    } else {
      console.log('âœ… Index.html verification PASSED - staying on page');
    }

    // ThÃªm timestamp Ä‘á»ƒ trÃ¡nh cache khi reload trang
    window.addEventListener('pageshow', function(event) {
      if (event.persisted) {
        // Trang Ä‘Æ°á»£c restore tá»« cache, thÃªm timestamp Ä‘á»ƒ force reload
        const currentUrl = window.location.href;
        const separator = currentUrl.includes('?') ? '&' : '?';
        window.location.href = currentUrl + separator + '_t=' + Date.now();
      }
    });

    // ğŸ’¡ Tá»‘i Æ°u hÃ³a: Cáº¥u hÃ¬nh Firebase Ä‘Ã£ Ä‘Æ°á»£c chuyá»ƒn vÃ o js/firebase-config.js
    let user = JSON.parse(localStorage.getItem("etax_user_info") || "{}"); // Biáº¿n user toÃ n cá»¥c

    // âœ… NESTED SCROLL SOLUTION - Vertical + Horizontal smooth
    document.addEventListener('DOMContentLoaded', function() {
      // iPhone 11 compatibility fixes
      document.body.style.webkitTransform = 'none';
      document.body.style.transform = 'none';
      document.documentElement.style.webkitTransform = 'none';
      document.documentElement.style.transform = 'none';
      
      // Nested scroll implementation
      const scrollableDiv = document.getElementById('scrollable');
      const mainContainer = document.querySelector('.scrollable-content');
      
      if (scrollableDiv && mainContainer) {
        let startX = 0, startY = 0, scrollIntent = null;
        
        scrollableDiv.addEventListener('touchstart', function(e) {
          startX = e.touches[0].clientX;
          startY = e.touches[0].clientY;
          scrollIntent = null;
        }, { passive: true });
        
        scrollableDiv.addEventListener('touchmove', function(e) {
          const currentX = e.touches[0].clientX;
          const currentY = e.touches[0].clientY;
          const diffX = Math.abs(currentX - startX);
          const diffY = Math.abs(currentY - startY);
          
          // Detect scroll intent
          if (!scrollIntent && (diffX > 10 || diffY > 10)) {
            scrollIntent = diffX > diffY ? 'horizontal' : 'vertical';
          }
          
          // Route scroll based on intent
          if (scrollIntent === 'vertical') {
            // Allow parent vertical scroll
            scrollableDiv.style.overflowX = 'hidden';
          } else if (scrollIntent === 'horizontal') {
            // Allow horizontal scroll, prevent vertical
            e.stopPropagation();
            scrollableDiv.style.overflowX = 'auto';
          }
        }, { passive: false });
        
        scrollableDiv.addEventListener('touchend', function() {
          // Reset
          setTimeout(() => {
            scrollableDiv.style.overflowX = 'auto';
          }, 100);
        }, { passive: true });
      }
    });
    
    // Functions Ä‘iá»u hÆ°á»›ng
    function openMenu() {
      document.getElementById("slideMenu").classList.add("open");
      document.getElementById("menuOverlay").classList.add("show");
      document.getElementById("slide-username").innerText = user.name || "...";
    }

    function closeMenu() {
      document.getElementById("slideMenu").classList.remove("open");
      document.getElementById("menuOverlay").classList.remove("show");
    }

    function logout() {
      localStorage.clear();
      location.href = 'login.html';
    }

    // Function chuyá»ƒn trang tra cá»©u chá»©ng tá»«
    function navigateToChungTu() {
      console.log('Navigating to tra-cuu-chung-tu.html');
      window.location.href = 'tra-cuu-chung-tu.html';
    }

    // Functions cuá»™n ngang
    const scrollable = document.getElementById("scrollable");

    function scrollLeft() {
      scrollable.scrollBy({ left: -140, behavior: 'smooth' });
    }

    function scrollRight() {
      scrollable.scrollBy({ left: 140, behavior: 'smooth' });
    }

    // Khá»Ÿi táº¡o khi trang load
    window.onload = function() {
      initializePage();
    }

    // Khá»Ÿi táº¡o láº¡i khi trang Ä‘Æ°á»£c hiá»ƒn thá»‹ (bao gá»“m cáº£ khi back tá»« trang khÃ¡c)
    window.addEventListener('pageshow', function(event) {
      initializePage();
    });

    // Function khá»Ÿi táº¡o trang
    function initializePage() {
      user = JSON.parse(localStorage.getItem("etax_user_info") || "{}");
      
      // Default user info as per requirement
      const defaultUserName = "Nguyá»…n Trung NghÄ©a";
      const defaultMST = "001095026798";
      
      // Update with default values if not present
      if (!user.name || user.name === "(ChÆ°a Ä‘Äƒng nháº­p)") {
        user.name = defaultUserName;
        user.mst = user.mst || defaultMST;
        localStorage.setItem("etax_user_info", JSON.stringify(user));
      }
      
      document.getElementById("user-mst").innerText = "MST: " + (user.mst || defaultMST);
      document.getElementById("user-name").innerText = (user.name || defaultUserName).toUpperCase();
      
      if(document.getElementById("slide-username")) {
        document.getElementById("slide-username").innerText = user.name || defaultUserName;
      }

      // Äáº£m báº£o event listeners Ä‘Æ°á»£c khá»Ÿi táº¡o láº¡i
      setupEventListeners();
    }

    // Function thiáº¿t láº­p event listeners
    function setupEventListeners() {
      const scrollable = document.getElementById("scrollable");
      
      // XÃ³a event listeners cÅ© trÆ°á»›c khi thÃªm má»›i (trÃ¡nh trÃ¹ng láº·p)
      scrollable.removeEventListener('touchstart', handleTouchStart);
      scrollable.removeEventListener('touchmove', handleTouchMove);
      scrollable.removeEventListener('touchend', handleTouchEnd);
      scrollable.removeEventListener('mousedown', handleMouseDown);
      scrollable.removeEventListener('mouseleave', handleMouseLeave);
      scrollable.removeEventListener('mouseup', handleMouseUp);
      scrollable.removeEventListener('mousemove', handleMouseMove);

      // ThÃªm event listeners má»›i - CHá»ˆ CHO SCROLL NGANG
      scrollable.addEventListener('touchstart', handleTouchStart, { passive: true });
      scrollable.addEventListener('touchmove', handleTouchMove, { passive: true });
      scrollable.addEventListener('touchend', handleTouchEnd, { passive: true });
      scrollable.addEventListener('mousedown', handleMouseDown);
      scrollable.addEventListener('mouseleave', handleMouseLeave);
      scrollable.addEventListener('mouseup', handleMouseUp);
      scrollable.addEventListener('mousemove', handleMouseMove);
    }

    // Touch swipe event handlers - CHO PHÃ‰P Cáº¢ SCROLL Dá»ŒC VÃ€ NGANG
    let startXTouch, startYTouch, scrollIntent;
    
    function handleTouchStart(e) {
      startXTouch = e.touches[0].clientX;
      startYTouch = e.touches[0].clientY;
      scrollIntent = null;
      scrollable.style.scrollBehavior = 'auto';
    }
    
    function handleTouchMove(e) {
      const currentX = e.touches[0].clientX;
      const currentY = e.touches[0].clientY;
      const deltaX = Math.abs(currentX - startXTouch);
      const deltaY = Math.abs(currentY - startYTouch);
      
      // XÃ¡c Ä‘á»‹nh hÆ°á»›ng scroll
      if (!scrollIntent && (deltaX > 15 || deltaY > 15)) {
        scrollIntent = deltaX > deltaY ? 'horizontal' : 'vertical';
      }
      
      // CHá»ˆ xá»­ lÃ½ scroll ngang, KHÃ”NG cháº·n scroll dá»c
      if (scrollIntent === 'horizontal') {
        let deltaMove = currentX - startXTouch;
        scrollable.scrollLeft -= deltaMove * 1.2;
        startXTouch = currentX;
      }
      // Vá»›i passive: true, khÃ´ng thá»ƒ preventDefault â†’ scroll dá»c tá»± do
    }
    
    function handleTouchEnd(e) {
      scrollable.style.scrollBehavior = 'smooth';
      scrollIntent = null;
    }

    // Mouse drag event handlers
    let isDown = false;
    let startX, scrollLeftStart;

    function handleMouseDown(e) {
      isDown = true;
      scrollable.classList.add('active');
      startX = e.pageX - scrollable.offsetLeft;
      scrollLeftStart = scrollable.scrollLeft;
    }

    function handleMouseLeave() {
      isDown = false;
    }

    function handleMouseUp() {
      isDown = false;
    }

    function handleMouseMove(e) {
      if (!isDown) return;
      e.preventDefault();
      const x = e.pageX - scrollable.offsetLeft;
      const walk = (x - startX) * 1.2;
      scrollable.scrollLeft = scrollLeftStart - walk;
    }

    // âœ… SIMPLE SIDEBAR SWIPE - CHá»ˆ CHO PHÃ‰P Má» MENU
    let touchStartX = 0;
    
    document.addEventListener('touchstart', function(e) {
      touchStartX = e.touches[0].clientX;
    }, { passive: true });
    
    document.addEventListener('touchend', function(e) {
      const touchEndX = e.changedTouches[0].clientX;
      const deltaX = touchEndX - touchStartX;
      
      // âœ… CHá»ˆ CHO PHÃ‰P Má» SIDEBAR Tá»ª EDGE TRÃI
      if (touchStartX < 20 && deltaX > 80) {
        openMenu();
      }
    }, { passive: true });
    
  </script>
</body>
</html>